

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Program Listing for File Exception.h &#8212; PyTorch main documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cpp_theme.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
    <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/program_listing_file_c10_util_Exception.h';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
<link rel="canonical" href="/api/program_listing_file_c10_util_Exception.h.html" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
<link rel="stylesheet" type="text/css" href="../_static/css/theme.css" crossorigin="anonymous">
<script type="text/javascript" src="../_static/js/theme.js"></script>
<meta property="og:image" content="../_static/img/pytorch_seo.png" />
<link rel="stylesheet" href="../_static/webfonts/all.min.css" crossorigin="anonymous">
<meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval' blob:;">
<meta name="pytorch_project" content="">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id="
   height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
   <!-- End Google Tag Manager (noscript) -->
   <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
   new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
   j.onload = function() {
     window.dispatchEvent(new Event('gtm_loaded'));
     console.log('GTM loaded successfully');
   };
   })(window,document,'script','dataLayer','');
</script>
 <!-- End Google Tag Manager -->
 <!-- Facebook Pixel Code -->
<script>
   !function(f,b,e,v,n,t,s)
   {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
   n.callMethod.apply(n,arguments):n.queue.push(arguments)};
   if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
   n.queue=[];t=b.createElement(e);t.async=!0;
   t.src=v;s=b.getElementsByTagName(e)[0];
   s.parentNode.insertBefore(t,s)}(window,document,'script',
   'https://connect.facebook.net/en_US/fbevents.js');
   fbq('init', '243028289693773');
   fbq('track', 'PageView');
</script>
<script>
   document.documentElement.setAttribute('data-version', 'main');
 </script>
<noscript>
   <img height="1" width="1" src="https://www.facebook.com/tr?id=243028289693773&ev=PageView&noscript=1"/>
</noscript>
<script>
   function gtag() {
    window.dataLayer.push(arguments);
   }
</script>
<!-- End Facebook Pixel Code -->

<script async src="https://cse.google.com/cse.js?cx=e65585f8c3ea1440e"></script>

   <!--
   Search engines should not index the main version of documentation.
   Stable documentation are built without release == 'main'.
   -->
   <meta name="robots" content="noindex">


  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

  </head>
<body data-feedback-url="https://github.com/pytorch/pytorch" class="pytorch-body">
     <div class="container-fluid header-holder tutorials-header" id="header-holder">
   <div class="header-container-wrapper">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                <span>Learn</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/get-started">
                  <span class=dropdown-title>Get Started</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials">
                  <span class="dropdown-title">Tutorials</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/basics/intro.html">
                  <span class="dropdown-title">Learn the Basics</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/recipes/recipes_index.html">
                  <span class="dropdown-title">PyTorch Recipes</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/introyt.html">
                  <span class="dropdown-title">Intro to PyTorch - YouTube Series</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/webinars/">
                  <span class="dropdown-title">Webinars</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span>Community</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://landscape.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Landscape</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/join-ecosystem">
                  <span class="dropdown-title">Join the Ecosystem</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/community-hub/">
                  <span class="dropdown-title">Community Hub</span>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/">
                  <span class="dropdown-title">Forums</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class=dropdown-title>Developer Resources</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/contributor-awards/">
                  <span class="dropdown-title">Contributor Awards</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/community-events/">
                  <span class="dropdown-title">Community Events</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/programs/ambassadors/">
                  <span class="dropdown-title">PyTorch Ambassadors</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span>Projects</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/pytorch/">
                  <span class="dropdown-title">PyTorch</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/vllm/">
                  <span class="dropdown-title">vLLM</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/deepspeed/">
                  <span class="dropdown-title">DeepSpeed</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/host-your-project/">
                  <span class="dropdown-title">Host Your Project</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span> Docs</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/pytorch-domains">
                  <span class="dropdown-title">Domains</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span>Blogs & News</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/blog/">
                  <span class="dropdown-title">Blog</span>
                </a>
                 <a class="nav-dropdown-item" href="https://pytorch.org/announcements">
                  <span class="dropdown-title">Announcements</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/case-studies/">
                  <span class="dropdown-title">Case Studies</span>
                <a class="nav-dropdown-item" href="https://pytorch.org/events">
                  <span class="dropdown-title">Events</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/newsletter">
                  <span class="dropdown-title">Newsletter</span>
                </a>
            </div>
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span>About</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/foundation">
                  <span class="dropdown-title">PyTorch Foundation</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/members">
                  <span class="dropdown-title">Members</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/governing-board">
                  <span class="dropdown-title">Governing Board</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tac">
                  <span class="dropdown-title">Technical Advisory Council</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/credits">
                  <span class="dropdown-title">Cloud Credit Program</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/staff">
                  <span class="dropdown-title">Staff</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/contact">
                  <span class="dropdown-title">Contact</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div class="no-dropdown main-menu-button">
              <a href="https://pytorch.org/join" data-cta="join">
                JOIN
              </a>
            </div>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu">
        <i class="fa-solid fa-ellipsis"></i>
      </a>
    </div>
  </div>
 </div>

 <!-- Begin Mobile Menu -->

<div class="mobile-main-menu">
  <div class="container-fluid">
    <div class="header-container-wrapper">
      <div class="mobile-main-menu-header-container">
        <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu">
        </a>
      </div>
    </div>
  </div>

  <div class="mobile-main-menu-links-container">
    <div class="main-menu">
      <ul>
         <li class="resources-mobile-menu-title">
           <a>Learn</a>
         </li>
         <ul class="resources-mobile-menu-items">
           <li>
             <a href="https://pytorch.org/get-started">Get Started</a>
           </li>
           <li>
             <a href="https://pytorch.org/tutorials">Tutorials</a>
           </li>
           <li>
             <a href="https://pytorch.org/tutorials/beginner/basics/intro.html">Learn the Basics</a>
           </li>
           <li>
             <a href="https://pytorch.org/tutorials/recipes/recipes_index.html">PyTorch Recipes</a>
           </li>
           <li>
             <a href="https://pytorch.org/tutorials/beginner/introyt.html">Introduction to PyTorch - YouTube Series</a>
           </li>
           <li>
            <a href="https://pytorch.org/webinars/">Webinars</a>
          </li>
        </ul>
         <li class="resources-mobile-menu-title">
           <a>Community</a>
         </li>
         <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://landscape.pytorch.org/">Landscape</a>
          </li>
          <li>
             <a href="https://pytorch.org/join-ecosystem">Join the Ecosystem</a>
           </li>
           <li>
             <a href="https://pytorch.org/community-hub/">Community Hub</a>
           </li>
           <li>
             <a href="https://discuss.pytorch.org/">Forums</a>
           </li>
           <li>
             <a href="https://pytorch.org/resources">Developer Resources</a>
           </li>
           <li>
             <a href="https://pytorch.org/contributor-awards/">Contributor Awards</a>
           </li>
           <li>
            <a href="https://pytorch.org/community-events/">Community Events</a>
          </li>
          <li>
            <a href="https://pytorch.org/programs/ambassadors/">PyTorch Ambassadors</a>
          </li>
       </ul>

         <li class="resources-mobile-menu-title">
           <a>Projects</a>
         </li>

         <ul class="resources-mobile-menu-items">
           <li>
             <a href="https://pytorch.org/projects/pytorch/">PyTorch</a>
           </li>

           <li>
             <a href="https://pytorch.org/projects/vllm/">vLLM</a>
           </li>
           <li>
            <a href="https://pytorch.org/projects/deepspeed/">DeepSpeed</a>
          </li>
          <li>
             <a href="https://pytorch.org/projects/host-your-project/">Host Your Project</a>
           </li>
         </ul>

         <li class="resources-mobile-menu-title">
           <a>Docs</a>
         </li>

         <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
          </li>

          <li>
            <a href="https://pytorch.org/pytorch-domains">Domains</a>
          </li>
        </ul>

        <li class="resources-mobile-menu-title">
          <a>Blog & News</a>
        </li>

         <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>
          <li>
            <a href="https://pytorch.org/announcements">Announcements</a>
          </li>

          <li>
            <a href="https://pytorch.org/case-studies/">Case Studies</a>
          </li>
          <li>
            <a href="https://pytorch.org/events">Events</a>
          </li>
          <li>
             <a href="https://pytorch.org/newsletter">Newsletter</a>
           </li>
        </ul>

        <li class="resources-mobile-menu-title">
          <a>About</a>
        </li>

        <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://pytorch.org/foundation">PyTorch Foundation</a>
          </li>
          <li>
            <a href="https://pytorch.org/members">Members</a>
          </li>
          <li>
            <a href="https://pytorch.org/governing-board">Governing Board</a>
          </li>
          <li>
            <a href="https://pytorch.org/tac">Technical Advisory Council</a>
         </li>
         <li>
             <a href="https://pytorch.org/credits">Cloud Credit Program</a>
          </li>
          <li>
             <a href="https://pytorch.org/staff">Staff</a>
          </li>
          <li>
             <a href="https://pytorch.org/contact">Contact</a>
          </li>
        </ul>
      </ul>
    </div>
  </div>
</div>

<!-- End Mobile Menu -->
   
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>

  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">
  <a href="../index.html" class="version">main</a>
</div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installing.html">
    Installing C++ Distributions of PyTorch
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../frontend.html">
    The C++ Frontend
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="library_root.html">
    Library API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/faq.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/inference_mode.html">
    Inference Mode
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notes/maybe_owned.html">
    MaybeOwned<Tensor>
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notes/tensor_basics.html">
    Tensor Basics
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notes/tensor_creation.html">
    Tensor Creation API
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notes/tensor_cuda_stream.html">
    Tensor CUDA Stream API
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notes/tensor_indexing.html">
    Tensor Indexing API
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notes/versioning.html">
    Library Versioning
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
  
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/PyTorch" title="X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pytorch/pytorch" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.pytorch.org/" title="PyTorch Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyTorch Forum</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torch/" title="PyPi" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPi</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installing.html">
    Installing C++ Distributions of PyTorch
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../frontend.html">
    The C++ Frontend
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="library_root.html">
    Library API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/faq.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/inference_mode.html">
    Inference Mode
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/maybe_owned.html">
    MaybeOwned<Tensor>
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/tensor_basics.html">
    Tensor Basics
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/tensor_creation.html">
    Tensor Creation API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/tensor_cuda_stream.html">
    Tensor CUDA Stream API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/tensor_indexing.html">
    Tensor Indexing API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/versioning.html">
    Library Versioning
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
  
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/PyTorch" title="X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pytorch/pytorch" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.pytorch.org/" title="PyTorch Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyTorch Forum</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torch/" title="PyPi" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPi</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Program Listing for File Exception.h</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Program...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">
<div class="rating">
    Rate this Page
    <div class="stars">
        
        <span class="star" data-behavior="tutorial-rating" data-count="1" data-value="1">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="2" data-value="2">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="3" data-value="3">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="4" data-value="4">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="5" data-value="5">★</span>
        
    </div>
</div>
</div>
      
    </div>
  
</div>
</div>
              
              
  
<div id="searchbox"></div>
  <article class="bd-article"id="pytorch-article" itemscope="itemscope" itemtype="https://schema.org/Article" itemprop="articleBody">
   <meta itemprop="headline" content="Program Listing for File Exception.h">
   <meta itemprop="description" content="PyTorch documentation">
   <meta itemprop="datePublished" content="">
   <meta itemprop="dateModified" content="">
   <meta itemprop="author" content="PyTorch Contributors">
   <!-- Hidden breadcrumb schema for SEO only -->
   <div style="display:none;" itemscope itemtype="https://schema.org/BreadcrumbList">
      
      <div itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <meta itemprop="name" content="Program Listing for File Exception.h">
        <meta itemprop="position" content="1">
      </div>
   </div>

    
    
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="section" id="program-listing-for-file-exception-h">
<span id="program-listing-file-c10-util-exception-h"></span><h1>Program Listing for File Exception.h<a class="headerlink" href="#program-listing-for-file-exception-h" title="Permalink to this heading">#</a></h1>
<p>↰ <a class="reference internal" href="file_c10_util_Exception.h.html#file-c10-util-exception-h"><span class="std std-ref">Return to documentation for file</span></a> (<code class="docutils literal notranslate"><span class="pre">c10/util/Exception.h</span></code>)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef C10_UTIL_EXCEPTION_H_</span>
<span class="cp">#define C10_UTIL_EXCEPTION_H_</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;c10/macros/Export.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;c10/macros/Macros.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;c10/util/Backtrace.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;c10/util/Lazy.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;c10/util/StringUtil.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdint&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;exception&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;variant&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="cp">#if defined(_MSC_VER) &amp;&amp; _MSC_VER &lt;= 1900</span>
<span class="cp">#define __func__ __FUNCTION__</span>
<span class="cp">#endif</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">c10</span><span class="w"> </span><span class="p">{</span>

<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="k">private</span><span class="o">:</span>
<span class="w">  </span><span class="c1">// The actual error message.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">msg_</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Context for the message (in order of decreasing specificity).  Context will</span>
<span class="w">  </span><span class="c1">// be automatically formatted appropriately, so it is not necessary to add</span>
<span class="w">  </span><span class="c1">// extra leading/trailing newlines to strings inside this vector</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">context_</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// The C++ backtrace at the point when this exception was raised.  This</span>
<span class="w">  </span><span class="c1">// may be empty if there is no valid backtrace.  (We don&#39;t use optional</span>
<span class="w">  </span><span class="c1">// here to reduce the dependencies this file has.)</span>
<span class="w">  </span><span class="n">Backtrace</span><span class="w"> </span><span class="n">backtrace_</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// These two are derived fields from msg_stack_ and backtrace_, but we need</span>
<span class="w">  </span><span class="c1">// fields for the strings so that we can return a const char* (as the</span>
<span class="w">  </span><span class="c1">// signature of std::exception requires).  Currently, the invariant</span>
<span class="w">  </span><span class="c1">// is that these fields are ALWAYS populated consistently with respect</span>
<span class="w">  </span><span class="c1">// to msg_stack_ and backtrace_.</span>
<span class="w">  </span><span class="k">mutable</span><span class="w"> </span><span class="n">OptimisticLazy</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">what_</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">what_without_backtrace_</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// This is a little debugging trick: you can stash a relevant pointer</span>
<span class="w">  </span><span class="c1">// in caller, and then when you catch the exception, you can compare</span>
<span class="w">  </span><span class="c1">// against pointers you have on hand to get more information about</span>
<span class="w">  </span><span class="c1">// where the exception came from.  In Caffe2, this is used to figure</span>
<span class="w">  </span><span class="c1">// out which operator raised an exception.</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">caller_</span><span class="p">;</span>

<span class="w"> </span><span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="c1">// PyTorch-style Error constructor.  NB: the implementation of this</span>
<span class="w">  </span><span class="c1">// is actually in Logging.cpp</span>
<span class="w">  </span><span class="n">Error</span><span class="p">(</span><span class="n">SourceLocation</span><span class="w"> </span><span class="n">source_location</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Caffe2-style error message</span>
<span class="w">  </span><span class="n">Error</span><span class="p">(</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="p">,</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">line</span><span class="p">,</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">condition</span><span class="p">,</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span>
<span class="w">      </span><span class="n">Backtrace</span><span class="w"> </span><span class="n">backtrace</span><span class="p">,</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Base constructor</span>
<span class="w">  </span><span class="n">Error</span><span class="p">(</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span>
<span class="w">      </span><span class="n">Backtrace</span><span class="w"> </span><span class="n">backtrace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Add some new context to the message stack.  The last added context</span>
<span class="w">  </span><span class="c1">// will be formatted at the end of the context list upon printing.</span>
<span class="w">  </span><span class="c1">// WARNING: This method is O(n) in the size of the stack, so don&#39;t go</span>
<span class="w">  </span><span class="c1">// wild adding a ridiculous amount of context to error messages.</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">add_context</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">msg</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">msg_</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">context</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">context_</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">Backtrace</span><span class="o">&amp;</span><span class="w"> </span><span class="n">backtrace</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="nf">what</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="nf">caller</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">caller_</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="nf">what_without_backtrace</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">what_without_backtrace_</span><span class="p">.</span><span class="n">c_str</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w"> </span><span class="k">private</span><span class="o">:</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">refresh_what</span><span class="p">();</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">compute_what</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">include_backtrace</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">Warning</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">UserWarning</span><span class="w"> </span><span class="p">{};</span>
<span class="w">  </span><span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">DeprecationWarning</span><span class="w"> </span><span class="p">{};</span>

<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">warning_variant_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">variant</span><span class="o">&lt;</span><span class="n">UserWarning</span><span class="p">,</span><span class="w"> </span><span class="n">DeprecationWarning</span><span class="o">&gt;</span><span class="p">;</span>

<span class="w">  </span><span class="n">Warning</span><span class="p">(</span>
<span class="w">      </span><span class="n">warning_variant_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">SourceLocation</span><span class="o">&amp;</span><span class="w"> </span><span class="n">source_location</span><span class="p">,</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span>
<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">verbatim</span><span class="p">);</span>

<span class="w">  </span><span class="n">Warning</span><span class="p">(</span>
<span class="w">      </span><span class="n">warning_variant_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span>
<span class="w">      </span><span class="n">SourceLocation</span><span class="w"> </span><span class="n">source_location</span><span class="p">,</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span>
<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">verbatim</span><span class="p">);</span>

<span class="w">  </span><span class="n">Warning</span><span class="p">(</span>
<span class="w">      </span><span class="n">warning_variant_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span>
<span class="w">      </span><span class="n">SourceLocation</span><span class="w"> </span><span class="n">source_location</span><span class="p">,</span>
<span class="w">      </span><span class="o">::</span><span class="n">c10</span><span class="o">::</span><span class="n">detail</span><span class="o">::</span><span class="n">CompileTimeEmptyString</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span>
<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">verbatim</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Getters for members</span>
<span class="w">  </span><span class="n">warning_variant_t</span><span class="w"> </span><span class="nf">type</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">SourceLocation</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">source_location</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">msg</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="nf">verbatim</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w"> </span><span class="k">private</span><span class="o">:</span>
<span class="w">  </span><span class="c1">// The type of warning</span>
<span class="w">  </span><span class="n">warning_variant_t</span><span class="w"> </span><span class="n">type_</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Where the warning happened.</span>
<span class="w">  </span><span class="n">SourceLocation</span><span class="w"> </span><span class="n">source_location_</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// The actual warning message.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">msg_</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// See note: [Verbatim Warnings]</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">verbatim_</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span><span class="w"> </span><span class="n">UserWarning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Warning</span><span class="o">::</span><span class="n">UserWarning</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="n">DeprecationWarning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Warning</span><span class="o">::</span><span class="n">DeprecationWarning</span><span class="p">;</span>

<span class="c1">// Issue a warning with a given message. Dispatched to the current</span>
<span class="c1">// warning handler.</span>
<span class="kt">void</span><span class="w"> </span><span class="n">C10_API</span><span class="w"> </span><span class="nf">warn</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Warning</span><span class="o">&amp;</span><span class="w"> </span><span class="n">warning</span><span class="p">);</span>

<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">WarningHandler</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">WarningHandler</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Warning</span><span class="o">&amp;</span><span class="w"> </span><span class="n">warning</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">WarningUtils</span><span class="w"> </span><span class="p">{</span>

<span class="c1">// Note: [Verbatim Warnings]</span>
<span class="c1">// Warnings originating in C++ code can appear out-of-place to Python users:</span>
<span class="c1">// a user runs a line in Python, but the warning references a line in C++.</span>
<span class="c1">// Some parts of PyTorch, like the JIT, are cognizant of this mismatch</span>
<span class="c1">// and take care to map warnings back to the user&#39;s program, but most</span>
<span class="c1">// of PyTorch simply throws a context-free warning. To allow warning</span>
<span class="c1">// handlers to add context where appropriate, warn takes the</span>
<span class="c1">// &quot;verbatim&quot; flag. When this is false a warning handler might append</span>
<span class="c1">// the C++ warning to a Python warning message that relates the warning</span>
<span class="c1">// back to the user&#39;s program. Callers who have already accounted for</span>
<span class="c1">// context in their warnings should set verbatim to true so their warnings</span>
<span class="c1">// appear without modification.</span>

<span class="n">C10_API</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">set_warning_handler</span><span class="p">(</span><span class="n">WarningHandler</span><span class="o">*</span><span class="w"> </span><span class="n">handler</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="n">C10_API</span><span class="w"> </span><span class="n">WarningHandler</span><span class="o">*</span><span class="w"> </span><span class="n">get_warning_handler</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">WarningHandlerGuard</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">WarningHandler</span><span class="o">*</span><span class="w"> </span><span class="n">prev_handler_</span><span class="p">;</span>

<span class="w"> </span><span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="n">WarningHandlerGuard</span><span class="p">(</span><span class="n">WarningHandler</span><span class="o">*</span><span class="w"> </span><span class="n">new_handler</span><span class="p">)</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">prev_handler_</span><span class="p">(</span><span class="n">c10</span><span class="o">::</span><span class="n">WarningUtils</span><span class="o">::</span><span class="n">get_warning_handler</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">c10</span><span class="o">::</span><span class="n">WarningUtils</span><span class="o">::</span><span class="n">set_warning_handler</span><span class="p">(</span><span class="n">new_handler</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">WarningHandlerGuard</span><span class="p">(</span><span class="n">WarningHandlerGuard</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">  </span><span class="n">WarningHandlerGuard</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">WarningHandlerGuard</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">  </span><span class="n">WarningHandlerGuard</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">WarningHandlerGuard</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">  </span><span class="n">WarningHandlerGuard</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">WarningHandlerGuard</span><span class="o">&amp;&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">  </span><span class="o">~</span><span class="n">WarningHandlerGuard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">c10</span><span class="o">::</span><span class="n">WarningUtils</span><span class="o">::</span><span class="n">set_warning_handler</span><span class="p">(</span><span class="n">prev_handler_</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>

<span class="n">C10_API</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">set_warnAlways</span><span class="p">(</span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="n">C10_API</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">get_warnAlways</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

<span class="c1">// A RAII guard that sets warn_always (not thread-local) on</span>
<span class="c1">// construction, and sets it back to the original value upon destruction.</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">WarnAlways</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="k">explicit</span><span class="w"> </span><span class="n">WarnAlways</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="w">  </span><span class="o">~</span><span class="n">WarnAlways</span><span class="p">();</span>

<span class="w"> </span><span class="k">private</span><span class="o">:</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">prev_setting</span><span class="p">;</span>
<span class="p">};</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// namespace WarningUtils</span>

<span class="c1">// Like Error, but we always report the C++ backtrace, instead of only</span>
<span class="c1">// reporting when TORCH_SHOW_CPP_STACKTRACES</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">ErrorAlwaysShowCppStacktrace</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="nf">what_without_backtrace</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">what</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Used in ATen for out-of-bound indices that can reasonably only be detected</span>
<span class="c1">// lazily inside a kernel (See: advanced indexing).  These turn into</span>
<span class="c1">// IndexError when they cross to Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">IndexError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used in ATen for invalid values.  These turn into</span>
<span class="c1">// ValueError when they cross to Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">ValueError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used in ATen for invalid types.  These turn into</span>
<span class="c1">// TypeError when they cross to Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">TypeError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used in ATen for functionality that is not implemented.  These turn into</span>
<span class="c1">// NotImplementedError when they cross to Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used in ATen for non finite indices.  These turn into</span>
<span class="c1">// ExitException when they cross to Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">EnforceFiniteError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used in Onnxifi backend lowering.  These turn into</span>
<span class="c1">// ExitException when they cross to Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">OnnxfiBackendSystemError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used for numerical errors from the linalg module. These</span>
<span class="c1">// turn into LinAlgError when they cross into Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">LinAlgError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">OutOfMemoryError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used for handling syntacitc erros in input arguments.</span>
<span class="c1">// They shuld turn into SytnaxError when the cross into Python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">SyntaxError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Base error type for all distributed errors.</span>
<span class="c1">// These turn into DistError when they cross into Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">DistError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used for collective communication library errors from the distributed module.</span>
<span class="c1">// These turn into DistBackendError when they cross into Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">DistBackendError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">DistError</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">DistError</span><span class="o">::</span><span class="n">DistError</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used for errors originating from the store.</span>
<span class="c1">// These turn into DistStoreError when they cross into Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">DistStoreError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">DistError</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">DistError</span><span class="o">::</span><span class="n">DistError</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used for errors originating from the TCP/IP stack and not from collective</span>
<span class="c1">// libraries. These turn into DistNetworkError when they cross into Python.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">DistNetworkError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">DistError</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">DistError</span><span class="o">::</span><span class="n">DistError</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Raised when a queue is empty and a non-blocking pop is called.</span>
<span class="c1">// Translated to torch.distributed.QueueEmptyError in Python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">C10_API</span><span class="w"> </span><span class="n">DistQueueEmptyError</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">DistStoreError</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">DistStoreError</span><span class="o">::</span><span class="n">DistStoreError</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// A utility function to return an exception std::string by prepending its</span>
<span class="c1">// exception type before its what() content</span>
<span class="n">C10_API</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">GetExceptionString</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// namespace c10</span>

<span class="c1">// Private helper macro for implementing TORCH_INTERNAL_ASSERT and TORCH_CHECK</span>
<span class="c1">//</span>
<span class="c1">// Note: In the debug build With MSVC, __LINE__ might be of long type (a.k.a</span>
<span class="c1">// int32_t), which is different from the definition of `SourceLocation` that</span>
<span class="c1">// requires unsigned int (a.k.a uint32_t) and may cause a compile error with the</span>
<span class="c1">// message: error C2397: conversion from &#39;long&#39; to &#39;uint32_t&#39; requires a</span>
<span class="c1">// narrowing conversion Here the static cast is used to pass the build. if this</span>
<span class="c1">// is used inside a lambda the __func__ macro expands to operator(), which isn&#39;t</span>
<span class="c1">// very useful, but hard to fix in a macro so suppressing the warning.</span>
<span class="cp">#define C10_THROW_ERROR(err_type, msg) \</span>
<span class="cp">  throw ::c10::err_type(               \</span>
<span class="cp">      {__func__, __FILE__, static_cast&lt;uint32_t&gt;(__LINE__)}, msg)</span>

<span class="cp">#define C10_BUILD_ERROR(err_type, msg) \</span>
<span class="cp">  ::c10::err_type({__func__, __FILE__, static_cast&lt;uint32_t&gt;(__LINE__)}, msg)</span>

<span class="c1">// Private helper macro for workaround MSVC misexpansion of nested macro</span>
<span class="c1">// invocations involving __VA_ARGS__.  See</span>
<span class="c1">// https://stackoverflow.com/questions/5134523/msvc-doesnt-expand-va-args-correctly</span>
<span class="cp">#define C10_EXPAND_MSVC_WORKAROUND(x) x</span>

<span class="c1">// On nvcc, C10_UNLIKELY thwarts missing return statement analysis.  In cases</span>
<span class="c1">// where the unlikely expression may be a constant, use this macro to ensure</span>
<span class="c1">// return statement analysis keeps working (at the cost of not getting the</span>
<span class="c1">// likely/unlikely annotation on nvcc).</span>
<span class="c1">// https://github.com/pytorch/pytorch/issues/21418</span>
<span class="c1">//</span>
<span class="c1">// Currently, this is only used in the error reporting macros below.  If you</span>
<span class="c1">// want to use it more generally, move me to Macros.h</span>
<span class="c1">//</span>
<span class="c1">// TODO: Brian Vaughan observed that we might be able to get this to work on</span>
<span class="c1">// nvcc by writing some sort of C++ overload that distinguishes constexpr inputs</span>
<span class="c1">// from non-constexpr.  Since there isn&#39;t any evidence that losing C10_UNLIKELY</span>
<span class="c1">// in nvcc is causing us perf problems, this is not yet implemented, but this</span>
<span class="c1">// might be an interesting piece of C++ code for an intrepid bootcamper to</span>
<span class="c1">// write.</span>
<span class="cp">#if defined(__CUDACC__)</span>
<span class="cp">#define C10_UNLIKELY_OR_CONST(e) e</span>
<span class="cp">#else</span>
<span class="cp">#define C10_UNLIKELY_OR_CONST(e) C10_UNLIKELY(e)</span>
<span class="cp">#endif</span>

<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Error reporting macros</span>
<span class="c1">// ----------------------------------------------------------------------------</span>

<span class="cp">#ifdef STRIP_ERROR_MESSAGES</span>
<span class="cp">#define TORCH_RETHROW(e, ...) throw</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_RETHROW(e, ...)               \</span>
<span class="cp">  do {                                      \</span>
<span class="cp">    e.add_context(::c10::str(__VA_ARGS__)); \</span>
<span class="cp">    throw;                                  \</span>
<span class="cp">  } while (false)</span>
<span class="cp">#endif</span>

<span class="c1">// A utility macro to provide assert()-like functionality; that is, enforcement</span>
<span class="c1">// of internal invariants in code.  It supports an arbitrary number of extra</span>
<span class="c1">// arguments (evaluated only on failure), which will be printed in the assert</span>
<span class="c1">// failure message using operator&lt;&lt; (this is useful to print some variables</span>
<span class="c1">// which may be useful for debugging.)</span>
<span class="c1">//</span>
<span class="c1">// Usage:</span>
<span class="c1">//    TORCH_INTERNAL_ASSERT(should_be_true);</span>
<span class="c1">//    TORCH_INTERNAL_ASSERT(x == 0, &quot;x = &quot;, x);</span>
<span class="c1">//</span>
<span class="c1">// Assuming no bugs in PyTorch, the conditions tested by this macro should</span>
<span class="c1">// always be true; e.g., it should be possible to disable all of these</span>
<span class="c1">// conditions without changing observable user behavior.  If you would like to</span>
<span class="c1">// do error reporting for user input, please use TORCH_CHECK instead.</span>
<span class="c1">//</span>
<span class="c1">// NOTE: It is SAFE to use this macro in production code; on failure, this</span>
<span class="c1">// simply raises an exception, it does NOT unceremoniously quit the process</span>
<span class="c1">// (unlike assert()).</span>
<span class="c1">//</span>
<span class="cp">#ifdef STRIP_ERROR_MESSAGES</span>
<span class="cp">#define TORCH_INTERNAL_ASSERT(cond, ...)                              \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {                               \</span>
<span class="cp">    ::c10::detail::torchCheckFail(                                    \</span>
<span class="cp">        __func__,                                                     \</span>
<span class="cp">        __FILE__,                                                     \</span>
<span class="cp">        static_cast&lt;uint32_t&gt;(__LINE__),                              \</span>
<span class="cp">        #cond &quot; INTERNAL ASSERT FAILED at &quot; C10_STRINGIZE(__FILE__)); \</span>
<span class="cp">  }</span>
<span class="cp">#else</span>
<span class="c1">// It would be nice if we could build a combined string literal out of</span>
<span class="c1">// the TORCH_INTERNAL_ASSERT prefix and a user-provided string literal</span>
<span class="c1">// as the first argument, but there doesn&#39;t seem to be any good way to</span>
<span class="c1">// do that while still supporting having a first argument that isn&#39;t a</span>
<span class="c1">// string literal.</span>
<span class="cp">#define TORCH_INTERNAL_ASSERT(cond, ...)                                         \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {                                          \</span>
<span class="cp">    ::c10::detail::torchInternalAssertFail(                                      \</span>
<span class="cp">        __func__,                                                                \</span>
<span class="cp">        __FILE__,                                                                \</span>
<span class="cp">        static_cast&lt;uint32_t&gt;(__LINE__),                                         \</span>
<span class="cp">        #cond                                                                    \</span>
<span class="cp">        &quot; INTERNAL ASSERT FAILED at &quot; C10_STRINGIZE(__FILE__) &quot;:&quot; C10_STRINGIZE( \</span>
<span class="cp">            __LINE__) &quot;, please report a bug to PyTorch. &quot;,                      \</span>
<span class="cp">        c10::str(__VA_ARGS__));                                                  \</span>
<span class="cp">  }</span>
<span class="cp">#endif</span>

<span class="c1">// A utility macro to make it easier to test for error conditions from user</span>
<span class="c1">// input.  Like TORCH_INTERNAL_ASSERT, it supports an arbitrary number of extra</span>
<span class="c1">// arguments (evaluated only on failure), which will be printed in the error</span>
<span class="c1">// message using operator&lt;&lt; (e.g., you can pass any object which has</span>
<span class="c1">// operator&lt;&lt; defined.  Most objects in PyTorch have these definitions!)</span>
<span class="c1">//</span>
<span class="c1">// Usage:</span>
<span class="c1">//    TORCH_CHECK(should_be_true); // A default error message will be provided</span>
<span class="c1">//                                 // in this case; but we recommend writing an</span>
<span class="c1">//                                 // explicit error message, as it is more</span>
<span class="c1">//                                 // user friendly.</span>
<span class="c1">//    TORCH_CHECK(x == 0, &quot;Expected x to be 0, but got &quot;, x);</span>
<span class="c1">//</span>
<span class="c1">// On failure, this macro will raise an exception.  If this exception propagates</span>
<span class="c1">// to Python, it will convert into a Python RuntimeError.</span>
<span class="c1">//</span>
<span class="c1">// NOTE: It is SAFE to use this macro in production code; on failure, this</span>
<span class="c1">// simply raises an exception, it does NOT unceremoniously quit the process</span>
<span class="c1">// (unlike CHECK() from glog.)</span>
<span class="c1">//</span>
<span class="cp">#define TORCH_CHECK_WITH(error_t, cond, ...) \</span>
<span class="cp">  TORCH_CHECK_WITH_MSG(error_t, cond, &quot;&quot;, __VA_ARGS__)</span>

<span class="cp">#ifdef STRIP_ERROR_MESSAGES</span>
<span class="cp">#define TORCH_CHECK_MSG(cond, type, ...) \</span>
<span class="cp">  (#cond #type &quot; CHECK FAILED at &quot; C10_STRINGIZE(__FILE__))</span>
<span class="cp">#define TORCH_CHECK_WITH_MSG(error_t, cond, type, ...)                \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {                               \</span>
<span class="cp">    C10_THROW_ERROR(Error, TORCH_CHECK_MSG(cond, type, __VA_ARGS__)); \</span>
<span class="cp">  }</span>
<span class="cp">#else</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">c10</span><span class="o">::</span><span class="nn">detail</span><span class="w"> </span><span class="p">{</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="k">decltype</span><span class="p">(</span><span class="k">auto</span><span class="p">)</span><span class="w"> </span><span class="n">torchCheckMsgImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="cm">/*msg*/</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Args</span><span class="o">&amp;</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">::</span><span class="n">c10</span><span class="o">::</span><span class="n">str</span><span class="p">(</span><span class="n">args</span><span class="p">...);</span>
<span class="p">}</span>
<span class="kr">inline</span><span class="w"> </span><span class="n">C10_API</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">torchCheckMsgImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// If there is just 1 user-provided C-string argument, use it.</span>
<span class="kr">inline</span><span class="w"> </span><span class="n">C10_API</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">torchCheckMsgImpl</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="cm">/*msg*/</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// namespace c10::detail</span>

<span class="cp">#define TORCH_CHECK_MSG(cond, type, ...)                   \</span>
<span class="cp">  (::c10::detail::torchCheckMsgImpl(                       \</span>
<span class="cp">      &quot;Expected &quot; #cond                                    \</span>
<span class="cp">      &quot; to be true, but got false.  &quot;                      \</span>
<span class="cp">      &quot;(Could this error message be improved?  If so, &quot;    \</span>
<span class="cp">      &quot;please report an enhancement request to PyTorch.)&quot;, \</span>
<span class="cp">      ##__VA_ARGS__))</span>
<span class="cp">#define TORCH_CHECK_WITH_MSG(error_t, cond, type, ...)                  \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {                                 \</span>
<span class="cp">    C10_THROW_ERROR(error_t, TORCH_CHECK_MSG(cond, type, __VA_ARGS__)); \</span>
<span class="cp">  }</span>
<span class="cp">#endif</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">c10</span><span class="o">::</span><span class="nn">detail</span><span class="w"> </span><span class="p">{</span>

<span class="p">[[</span><span class="n">noreturn</span><span class="p">]]</span><span class="w"> </span><span class="n">C10_API</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">torchCheckFail</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">func</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="p">,</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">line</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>
<span class="p">[[</span><span class="n">noreturn</span><span class="p">]]</span><span class="w"> </span><span class="n">C10_API</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">torchCheckFail</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">func</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="p">,</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">line</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>

<span class="c1">// The c10::str() call that creates userMsg can have 1 of 3 return</span>
<span class="c1">// types depending on the number and types of arguments passed to</span>
<span class="c1">// TORCH_INTERNAL_ASSERT.  0 arguments will get a</span>
<span class="c1">// CompileTimeEmptyString, 1 const char * will be passed straight</span>
<span class="c1">// through, and anything else will get converted to std::string.</span>
<span class="p">[[</span><span class="n">noreturn</span><span class="p">]]</span><span class="w"> </span><span class="n">C10_API</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">torchInternalAssertFail</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">func</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="p">,</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">line</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">condMsg</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">userMsg</span><span class="p">);</span>
<span class="p">[[</span><span class="n">noreturn</span><span class="p">]]</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="n">C10_API</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">torchInternalAssertFail</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">func</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="p">,</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">line</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">condMsg</span><span class="p">,</span>
<span class="w">    </span><span class="o">::</span><span class="n">c10</span><span class="o">::</span><span class="n">detail</span><span class="o">::</span><span class="n">CompileTimeEmptyString</span><span class="w"> </span><span class="cm">/*userMsg*/</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">torchCheckFail</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">condMsg</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">[[</span><span class="n">noreturn</span><span class="p">]]</span><span class="w"> </span><span class="n">C10_API</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">torchInternalAssertFail</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">func</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="p">,</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">line</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">condMsg</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">userMsg</span><span class="p">);</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// namespace c10::detail</span>

<span class="cp">#ifdef STANDALONE_TORCH_HEADER</span>

<span class="c1">// TORCH_CHECK throws std::runtime_error instead of c10::Error which is</span>
<span class="c1">// useful when certain headers are used in a libtorch-independent way,</span>
<span class="c1">// e.g. when Vectorized&lt;T&gt; is used in AOTInductor generated code.</span>
<span class="cp">#ifdef STRIP_ERROR_MESSAGES</span>
<span class="cp">#define TORCH_CHECK(cond, ...)                \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {       \</span>
<span class="cp">    throw std::runtime_error(TORCH_CHECK_MSG( \</span>
<span class="cp">        cond,                                 \</span>
<span class="cp">        &quot;&quot;,                                   \</span>
<span class="cp">        __func__,                             \</span>
<span class="cp">        &quot;, &quot;,                                 \</span>
<span class="cp">        __FILE__,                             \</span>
<span class="cp">        &quot;:&quot;,                                  \</span>
<span class="cp">        __LINE__,                             \</span>
<span class="cp">        &quot;, &quot;,                                 \</span>
<span class="cp">        __VA_ARGS__));                        \</span>
<span class="cp">  }</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_CHECK(cond, ...)                \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {       \</span>
<span class="cp">    throw std::runtime_error(TORCH_CHECK_MSG( \</span>
<span class="cp">        cond,                                 \</span>
<span class="cp">        &quot;&quot;,                                   \</span>
<span class="cp">        __func__,                             \</span>
<span class="cp">        &quot;, &quot;,                                 \</span>
<span class="cp">        __FILE__,                             \</span>
<span class="cp">        &quot;:&quot;,                                  \</span>
<span class="cp">        __LINE__,                             \</span>
<span class="cp">        &quot;, &quot;,                                 \</span>
<span class="cp">        ##__VA_ARGS__));                      \</span>
<span class="cp">  }</span>
<span class="cp">#endif</span>

<span class="cp">#else</span>

<span class="cp">#ifdef STRIP_ERROR_MESSAGES</span>
<span class="cp">#define TORCH_CHECK(cond, ...)                   \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {          \</span>
<span class="cp">    ::c10::detail::torchCheckFail(               \</span>
<span class="cp">        __func__,                                \</span>
<span class="cp">        __FILE__,                                \</span>
<span class="cp">        static_cast&lt;uint32_t&gt;(__LINE__),         \</span>
<span class="cp">        TORCH_CHECK_MSG(cond, &quot;&quot;, __VA_ARGS__)); \</span>
<span class="cp">  }</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_CHECK(cond, ...)                     \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {            \</span>
<span class="cp">    ::c10::detail::torchCheckFail(                 \</span>
<span class="cp">        __func__,                                  \</span>
<span class="cp">        __FILE__,                                  \</span>
<span class="cp">        static_cast&lt;uint32_t&gt;(__LINE__),           \</span>
<span class="cp">        TORCH_CHECK_MSG(cond, &quot;&quot;, ##__VA_ARGS__)); \</span>
<span class="cp">  }</span>
<span class="cp">#endif</span>

<span class="cp">#endif</span>

<span class="c1">// An utility macro that does what `TORCH_CHECK` does if compiled in the host</span>
<span class="c1">// code, otherwise does nothing. Supposed to be used in the code shared between</span>
<span class="c1">// host and device code as an alternative for `TORCH_CHECK`.</span>
<span class="cp">#if defined(__CUDACC__) || defined(__HIPCC__)</span>
<span class="cp">#define TORCH_CHECK_IF_NOT_ON_CUDA(cond, ...)</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_CHECK_IF_NOT_ON_CUDA(cond, ...) TORCH_CHECK(cond, ##__VA_ARGS__)</span>
<span class="cp">#endif</span>

<span class="c1">// Debug only version of TORCH_INTERNAL_ASSERT. This macro only checks in debug</span>
<span class="c1">// build, and does nothing in release build.  It is appropriate to use</span>
<span class="c1">// in situations where you want to add an assert to a hotpath, but it is</span>
<span class="c1">// too expensive to run this assert on production builds.</span>
<span class="cp">#ifdef NDEBUG</span>
<span class="c1">// Optimized version - generates no code.</span>
<span class="cp">#define TORCH_INTERNAL_ASSERT_DEBUG_ONLY(...) \</span>
<span class="cp">  while (false)                               \</span>
<span class="cp">  C10_EXPAND_MSVC_WORKAROUND(TORCH_INTERNAL_ASSERT(__VA_ARGS__))</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_INTERNAL_ASSERT_DEBUG_ONLY(...) \</span>
<span class="cp">  C10_EXPAND_MSVC_WORKAROUND(TORCH_INTERNAL_ASSERT(__VA_ARGS__))</span>
<span class="cp">#endif</span>

<span class="c1">// TODO: We&#39;re going to get a lot of similar looking string literals</span>
<span class="c1">// this way; check if this actually affects binary size.</span>

<span class="c1">// Like TORCH_CHECK, but raises LinAlgError instead of Error.</span>
<span class="cp">#define TORCH_CHECK_LINALG(cond, ...) \</span>
<span class="cp">  TORCH_CHECK_WITH_MSG(LinAlgError, cond, &quot;LINALG&quot;, __VA_ARGS__)</span>

<span class="c1">// Like TORCH_CHECK, but raises IndexErrors instead of Errors.</span>
<span class="cp">#define TORCH_CHECK_INDEX(cond, ...) \</span>
<span class="cp">  TORCH_CHECK_WITH_MSG(IndexError, cond, &quot;INDEX&quot;, __VA_ARGS__)</span>

<span class="c1">// Like TORCH_CHECK, but raises ValueErrors instead of Errors.</span>
<span class="cp">#define TORCH_CHECK_VALUE(cond, ...) \</span>
<span class="cp">  TORCH_CHECK_WITH_MSG(ValueError, cond, &quot;VALUE&quot;, __VA_ARGS__)</span>

<span class="c1">// Like TORCH_CHECK, but raises TypeErrors instead of Errors.</span>
<span class="cp">#define TORCH_CHECK_TYPE(cond, ...) \</span>
<span class="cp">  TORCH_CHECK_WITH_MSG(TypeError, cond, &quot;TYPE&quot;, __VA_ARGS__)</span>

<span class="c1">// Like TORCH_CHECK, but raises NotImplementedErrors instead of Errors.</span>
<span class="cp">#define TORCH_CHECK_NOT_IMPLEMENTED(cond, ...) \</span>
<span class="cp">  TORCH_CHECK_WITH_MSG(NotImplementedError, cond, &quot;TYPE&quot;, __VA_ARGS__)</span>

<span class="cp">#define TORCH_CHECK_ALWAYS_SHOW_CPP_STACKTRACE(cond, ...) \</span>
<span class="cp">  TORCH_CHECK_WITH_MSG(                                   \</span>
<span class="cp">      ErrorAlwaysShowCppStacktrace, cond, &quot;TYPE&quot;, ##__VA_ARGS__)</span>

<span class="cp">#ifdef STRIP_ERROR_MESSAGES</span>
<span class="cp">#define WARNING_MESSAGE_STRING(...) \</span>
<span class="cp">  ::c10::detail::CompileTimeEmptyString {}</span>
<span class="cp">#else</span>
<span class="cp">#define WARNING_MESSAGE_STRING(...) ::c10::str(__VA_ARGS__)</span>
<span class="cp">#endif</span>

<span class="c1">// Report a warning to the user.  Accepts an arbitrary number of extra</span>
<span class="c1">// arguments which are concatenated into the warning message using operator&lt;&lt;</span>
<span class="c1">//</span>
<span class="cp">#ifdef DISABLE_WARN</span>
<span class="cp">#define _TORCH_WARN_WITH(...) ((void)0);</span>
<span class="cp">#else</span>
<span class="cp">#define _TORCH_WARN_WITH(warning_t, ...)                     \</span>
<span class="cp">  ::c10::warn(::c10::Warning(                                \</span>
<span class="cp">      warning_t(),                                           \</span>
<span class="cp">      {__func__, __FILE__, static_cast&lt;uint32_t&gt;(__LINE__)}, \</span>
<span class="cp">      WARNING_MESSAGE_STRING(__VA_ARGS__),                   \</span>
<span class="cp">      false));</span>
<span class="cp">#endif</span>

<span class="cp">#define TORCH_WARN(...) _TORCH_WARN_WITH(::c10::UserWarning, __VA_ARGS__);</span>

<span class="cp">#define TORCH_WARN_DEPRECATION(...) \</span>
<span class="cp">  _TORCH_WARN_WITH(::c10::DeprecationWarning, __VA_ARGS__);</span>

<span class="c1">// Report a warning to the user only once.  Accepts an arbitrary number of extra</span>
<span class="c1">// arguments which are concatenated into the warning message using operator&lt;&lt;</span>
<span class="c1">//</span>
<span class="cp">#define _TORCH_WARN_ONCE(...)                                \</span>
<span class="cp">  [[maybe_unused]] static const auto C10_ANONYMOUS_VARIABLE( \</span>
<span class="cp">      torch_warn_once_) = [&amp;] {                              \</span>
<span class="cp">    TORCH_WARN(__VA_ARGS__);                                 \</span>
<span class="cp">    return true;                                             \</span>
<span class="cp">  }()</span>

<span class="cp">#ifdef DISABLE_WARN</span>
<span class="cp">#define TORCH_WARN_ONCE(...) ((void)0);</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_WARN_ONCE(...)                   \</span>
<span class="cp">  if (::c10::WarningUtils::get_warnAlways()) { \</span>
<span class="cp">    TORCH_WARN(__VA_ARGS__);                   \</span>
<span class="cp">  } else {                                     \</span>
<span class="cp">    _TORCH_WARN_ONCE(__VA_ARGS__);             \</span>
<span class="cp">  }</span>
<span class="cp">#endif</span>

<span class="c1">// Report an error with a specific argument</span>
<span class="c1">// NOTE: using the argument name in TORCH_CHECK&#39;s message is preferred</span>
<span class="cp">#define TORCH_CHECK_ARG(cond, argN, ...) \</span>
<span class="cp">  TORCH_CHECK(cond, &quot;invalid argument &quot;, argN, &quot;: &quot;, __VA_ARGS__)</span>

<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Deprecated macros</span>
<span class="c1">// ----------------------------------------------------------------------------</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">c10</span><span class="o">::</span><span class="nn">detail</span><span class="w"> </span><span class="p">{</span>

<span class="cm">/*</span>
<span class="cm">// Deprecation disabled until we fix sites in our codebase</span>
<span class="cm">C10_DEPRECATED_MESSAGE(&quot;AT_ERROR(msg) is deprecated, use TORCH_CHECK(false, msg)</span>
<span class="cm">instead.&quot;)</span>
<span class="cm">*/</span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">deprecated_AT_ERROR</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>

<span class="cm">/*</span>
<span class="cm">// Deprecation disabled until we fix sites in our codebase</span>
<span class="cm">C10_DEPRECATED_MESSAGE(&quot;AT_ASSERT is deprecated, if you mean to indicate an</span>
<span class="cm">internal invariant failure, use &quot; \</span>
<span class="cm">                       &quot;TORCH_INTERNAL_ASSERT instead; if you mean to do user</span>
<span class="cm">error checking, use &quot; \ &quot;TORCH_CHECK.  See</span>
<span class="cm">https://github.com/pytorch/pytorch/issues/20287 for more details.&quot;)</span>
<span class="cm">*/</span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">deprecated_AT_ASSERT</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>

<span class="cm">/*</span>
<span class="cm">// Deprecation disabled until we fix sites in our codebase</span>
<span class="cm">C10_DEPRECATED_MESSAGE(&quot;AT_ASSERTM is deprecated, if you mean to indicate an</span>
<span class="cm">internal invariant failure, use &quot; \</span>
<span class="cm">                       &quot;TORCH_INTERNAL_ASSERT instead; if you mean to do user</span>
<span class="cm">error checking, use &quot; \ &quot;TORCH_CHECK.  See</span>
<span class="cm">https://github.com/pytorch/pytorch/issues/20287 for more details.&quot;)</span>
<span class="cm">*/</span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">deprecated_AT_ASSERTM</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// namespace c10::detail</span>

<span class="c1">// Deprecated alias; this alias was deprecated because people kept mistakenly</span>
<span class="c1">// using it for user error checking.  Use TORCH_INTERNAL_ASSERT or TORCH_CHECK</span>
<span class="c1">// instead. See https://github.com/pytorch/pytorch/issues/20287 for more</span>
<span class="c1">// details.</span>
<span class="cp">#define AT_ASSERT(...)                                              \</span>
<span class="cp">  do {                                                              \</span>
<span class="cp">    ::c10::detail::deprecated_AT_ASSERT();                          \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_INTERNAL_ASSERT(__VA_ARGS__)); \</span>
<span class="cp">  } while (false)</span>

<span class="c1">// Deprecated alias, like AT_ASSERT.  The new TORCH_INTERNAL_ASSERT macro</span>
<span class="c1">// supports both 0-ary and variadic calls, so having a separate</span>
<span class="c1">// message-accepting macro is not necessary.</span>
<span class="c1">//</span>
<span class="c1">// NB: we MUST include cond explicitly here, as MSVC will miscompile the macro</span>
<span class="c1">// expansion, shunting all of __VA_ARGS__ to cond.  An alternate workaround</span>
<span class="c1">// can be seen at</span>
<span class="c1">// https://stackoverflow.com/questions/5134523/msvc-doesnt-expand-va-args-correctly</span>
<span class="cp">#define AT_ASSERTM(cond, ...)                                             \</span>
<span class="cp">  do {                                                                    \</span>
<span class="cp">    ::c10::detail::deprecated_AT_ASSERTM();                               \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_INTERNAL_ASSERT(cond, __VA_ARGS__)); \</span>
<span class="cp">  } while (false)</span>

<span class="c1">// Deprecated alias; this alias was deprecated because it represents extra API</span>
<span class="c1">// surface that makes it hard for people to understand what macro to use.</span>
<span class="c1">// Use TORCH_CHECK(false, ...) or TORCH_INTERNAL_ASSERT(false, ...) to</span>
<span class="c1">// unconditionally fail at a line of code.</span>
<span class="cp">#define AT_ERROR(...)                                                        \</span>
<span class="cp">  do {                                                                       \</span>
<span class="cp">    ::c10::detail::deprecated_AT_ERROR();                                    \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_CHECK(false, ::c10::str(__VA_ARGS__))); \</span>
<span class="cp">  } while (false)</span>

<span class="cp">#endif </span><span class="c1">// C10_UTIL_EXCEPTION_H_</span>
</pre></div>
</div>
</div>


                </article>
              
  </article>

              
              
                <footer class="bd-footer-article">
                  <div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item">
<div class="feedback">
  
<div class="rating">
    Rate this Page
    <div class="stars">
        
        <span class="star" data-behavior="tutorial-rating" data-count="1" data-value="1">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="2" data-value="2">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="3" data-value="3">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="4" data-value="4">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="5" data-value="5">★</span>
        
    </div>
</div>

  <div class="feedback-send">
    <button class="feedback-btn"
            onclick="openGitHubIssue()"
            data-bs-title="Create a GitHub Issue"
            data-bs-placement="bottom"
            data-bs-toggle="tooltip"
            data-gtm="feedback-btn-click">Send Feedback
    </button>
  </div>
</div>


<div class="prev-next-area">
</div>

<div class="footer-info">
  <p class="copyright">
    
      
        © Copyright PyTorch Contributors.
      
      <br/>
    
  </p>

  <p class="theme-version">
    Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
  </p>
</div></div>
  
</div>
                </footer>
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc">
<div class="sidebar-secondary-items sidebar-secondary__inner">
    
       <div class="sidebar-secondary-item">
    <div class="tocsection sourcelink">
      <a href="../_sources/api/program_listing_file_c10_util_Exception.h.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
      </a>
    </div>
</div>
    




<div class="sidebar-secondary-item">
  <div class="sidebar-heading">PyTorch Libraries</div>
  <ul style="list-style-type: none; padding: 0; padding-bottom: 80px;">
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/audio/stable/" style="color: var(--pst-color-text-muted)">torchaudio</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/ao" style="color: var(--pst-color-text-muted)">torchao</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/executorch" style="color: var(--pst-color-text-muted)">ExecuTorch</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/torchrec" style="color: var(--pst-color-text-muted)">torchrec</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/serve/" style="color: var(--pst-color-text-muted)">torchserve</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/data" style="color: var(--pst-color-text-muted)">torchdata</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/data" style="color: var(--pst-color-text-muted)">torchvision</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/xla" style="color: var(--pst-color-text-muted)">PyTorch on XLA Devices</a></li>
  
  </ul>
</div>

</div>
</div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

   <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <h2>Docs</h2>
            <p>Access comprehensive developer documentation for PyTorch</p>
            <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
          </div>

          <div class="col-md-4">
            <h2>Tutorials</h2>
            <p>Get in-depth tutorials for beginners and advanced developers</p>
            <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
          </div>

          <div class="col-md-4">
            <h2>Resources</h2>
            <p>Find development resources and get your questions answered</p>
            <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
          </div>
        </div>
      </div>
  </div>

  <footer class="site-footer">
      <div class="container footer-container">

          
      <div class="newsletter" id="newsletter">
  
        <p
          class="newsletter__title is-style-max-width-800"><strong>Stay in touch</strong> for updates, event info, and the latest news</p>
      
      
          <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/embed/v2.js"></script>
          <script>
            hbspt.forms.create({
              region: "na1",
              portalId: "8112310",
              formId: "2fb2231c-000b-4ec5-88a0-1ab242549c9e"
            });
          </script>
          
      
        <p
          class="newsletter__privacy">By submitting this form, I consent to receive marketing emails from the LF and its projects regarding their events, training, research, developments, and related announcements. I understand that I can unsubscribe at any time using the links in the footers of the emails I receive. <a href="https://www.linuxfoundation.org/privacy/">Privacy Policy</a>.</p>
          
      </div>
      
  
  
      <div class="lf-grid">  
        <ul class="social-links">
          <li><a href="https://www.facebook.com/pytorch" target="_blank" title="PyTorch on Facebook">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="-0.51 -0.26 26.45 26.45" aria-label="Facebook"><path fill="currentColor" d="M25.497 13.075c0-2.45-.698-4.848-2.011-6.911a12.765 12.765 0 0 0-5.398-4.73A12.671 12.671 0 0 0 11.008.38a12.705 12.705 0 0 0-6.529 2.95A12.827 12.827 0 0 0 .563 9.358a12.896 12.896 0 0 0-.07 7.201 12.831 12.831 0 0 0 3.801 6.103 12.709 12.709 0 0 0 6.471 3.078v-8.957H7.53v-3.708h3.235v-2.824c0-3.213 1.903-4.988 4.813-4.988.956.014 1.909.097 2.852.25V8.67h-1.607a1.83 1.83 0 0 0-1.518.497 1.854 1.854 0 0 0-.561 1.505v2.404h3.535l-.563 3.708h-2.97v8.957a12.725 12.725 0 0 0 7.697-4.337 12.87 12.87 0 0 0 3.054-8.328z"/></svg>	
          </a></li>
          <li><a href="https://twitter.com/pytorch" target="_blank" title="PyTorch on X">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 300 300" aria-label="X"><path fill="currentColor" d="M178.57 127.15 290.27 0h-26.46l-97.03 110.38L89.34 0H0l117.13 166.93L0 300.25h26.46l102.4-116.59 81.8 116.59h89.34M36.01 19.54H76.66l187.13 262.13h-40.66"/></svg>
          </a></li>
          <li><a href="https://www.youtube.com/pytorch" target="_blank" title="PyTorch on YouTube">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0.21 0.27 34.45 25.07" aria-label="YouTube"><path fill="currentColor" d="M33.729 6.084s-.327-2.33-1.317-3.356a4.691 4.691 0 0 0-3.32-1.432c-4.634-.34-11.589-.34-11.589-.34h-.014s-6.954 0-11.59.342a4.692 4.692 0 0 0-3.32 1.432c-.993 1.025-1.315 3.354-1.315 3.354a52.189 52.189 0 0 0-.331 5.473v2.566c.014 1.829.125 3.656.331 5.472 0 0 .322 2.33 1.316 3.36 1.26 1.345 2.916 1.3 3.653 1.445 2.65.26 11.263.34 11.263.34s6.96-.01 11.597-.353a4.691 4.691 0 0 0 3.32-1.432c.993-1.026 1.316-3.356 1.316-3.356.206-1.817.316-3.644.33-5.473v-2.57a52.26 52.26 0 0 0-.33-5.472zM14.076 17.232V7.729l8.951 4.768-8.95 4.735z"/></svg>	
          </a></li>
          <li><a href="https://www.linkedin.com/company/pytorch" target="_blank" title="PyTorch on LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="-10.23 -10.23 531.96 531.96" aria-label="LinkedIn"><rect width="512" height="512" rx="0" fill="currentColor"/><circle fill="#000" cx="142" cy="138" r="37"/><path stroke="#000" stroke-width="66" d="M244 194v198M142 194v198"/><path fill="#000" d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
          </a></li>
          <li><a href="https://pytorch.slack.com" target="_blank" title="PyTorch Slack">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0.16 -0.03 21.19 21.19" aria-label="Slack"><path fill="currentColor" d="M4.896 13.27a2.147 2.147 0 0 1-2.141 2.142A2.147 2.147 0 0 1 .613 13.27c0-1.178.963-2.141 2.142-2.141h2.141v2.141zm1.08 0c0-1.178.962-2.141 2.141-2.141s2.142.963 2.142 2.141v5.363a2.147 2.147 0 0 1-2.142 2.141 2.147 2.147 0 0 1-2.141-2.142V13.27zm2.141-8.6a2.147 2.147 0 0 1-2.141-2.14c0-1.18.962-2.142 2.141-2.142s2.142.963 2.142 2.141v2.142H8.117zm0 1.08c1.179 0 2.141.962 2.141 2.141a2.147 2.147 0 0 1-2.141 2.142H2.755A2.147 2.147 0 0 1 .613 7.89c0-1.179.963-2.141 2.142-2.141h5.362zm8.599 2.141c0-1.179.963-2.141 2.141-2.141 1.179 0 2.143.962 2.143 2.14a2.147 2.147 0 0 1-2.142 2.142h-2.141V7.89zm-1.08 0a2.147 2.147 0 0 1-2.141 2.142 2.147 2.147 0 0 1-2.141-2.142V2.53c0-1.178.962-2.141 2.141-2.141s2.142.963 2.142 2.141v5.362zm-2.141 8.6c1.179 0 2.142.962 2.142 2.14a2.147 2.147 0 0 1-2.142 2.142 2.147 2.147 0 0 1-2.141-2.141V16.49h2.141zm0-1.08a2.147 2.147 0 0 1-2.141-2.141c0-1.179.962-2.142 2.141-2.142h5.362c1.179 0 2.142.963 2.142 2.142a2.147 2.147 0 0 1-2.142 2.142h-5.362z"></path></svg>
          </a></li>
          <li><a href="https://pytorch.org/wechat" title="PyTorch on WeChat">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0.14 -0.17 38.02 33.02" aria-label="WeChat"><path fill="currentColor" d="M26.289 10.976a12.972 12.972 0 0 0-8.742 3.53 10.386 10.386 0 0 0-3.224 8.795c-1.326-.164-2.535-.345-3.75-.448a2.332 2.332 0 0 0-1.273.216c-1.18.666-2.311 1.418-3.652 2.255.246-1.112.405-2.087.687-3.024a1.15 1.15 0 0 0-.523-1.52C1.737 17.902.02 13.601 1.307 9.165c1.189-4.1 4.11-6.587 8.077-7.884A13.54 13.54 0 0 1 24.18 5.617a10.135 10.135 0 0 1 2.109 5.359zM10.668 9.594a1.564 1.564 0 0 0-2.095-1.472 1.52 1.52 0 0 0-.895 1.964 1.502 1.502 0 0 0 1.391.966 1.545 1.545 0 0 0 1.598-1.46v.002zm8.15-1.566a1.567 1.567 0 0 0-1.528 1.543 1.528 1.528 0 0 0 1.571 1.492 1.52 1.52 0 0 0 1.375-2.117 1.518 1.518 0 0 0-1.415-.919l-.003.001z"></path><path fill="currentColor" d="M33.914 32.137c-1.075-.478-2.062-1.196-3.11-1.306-1.049-.11-2.145.494-3.24.605a10.821 10.821 0 0 1-8.781-2.864c-4.682-4.33-4.013-10.97 1.403-14.518 4.811-3.154 11.874-2.102 15.268 2.273a8.671 8.671 0 0 1-1.002 12.095c-1.046.929-1.422 1.693-.751 2.917.102.257.174.525.213.798zM21.68 20.292a1.264 1.264 0 1 0 .01-2.528 1.264 1.264 0 0 0-.01 2.528zm7.887-2.526a1.266 1.266 0 0 0-1.256 1.21 1.247 1.247 0 1 0 1.256-1.21z"></path></svg>
          </a></li>
        </ul>
      </div>
  
      <div class="privacy-policy">
        <div class="copyright">
          <p>
            &copy; PyTorch. Copyright © The Linux Foundation®. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For more information, including terms of use, privacy policy, and trademark usage, please see our <a href="https://www.linuxfoundation.org/legal/policies">Policies</a> page. <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage</a>. <a href="http://www.linuxfoundation.org/privacy">Privacy Policy</a>.
          </p>
        </div>
      </div>


       </div>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/img/pytorch-x.svg">
  </div>
</div>
 </footer>
   
  <footer class="bd-footer"><div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/img/pytorch-x.svg">
  </div>
</div>
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright PyTorch Contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
   <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Program Listing for File Exception.h",
        "description": "PyTorch Documentation. Explore PyTorch, an open-source machine learning library that accelerates the path from research prototyping to production deployment. Discover tutorials, API references, and guides to help you build and deploy deep learning models efficiently.",
        "author": {
          "@type": "Organization",
          "name": "PyTorch Contributors"
        },
        "datePublished": "",
        "dateModified": "",
      }
   </script>

  </body>
</html>